# MCP协议教程

在大模型技术飞速发展的当下，如何突破单体模型能力的边界，构建更强大、更灵活的智能系统，成为了开发者和研究者关注的核心问题。**MCP（Model Context Protocol，模型上下文协议）**作为一种轻量级、可扩展的协议，正逐渐成为模型协作与能力增强的关键技术方案。

本教程将带你系统了解 MCP 的核心思想与设计初衷，帮助你理解 MCP 为什么能够有效拓展大模型的能力边界，支持复杂任务的分工协作与模块化处理。我们将以实践为导向，演示如何在不同的 MCP 客户端中正确配置 MCP Server，并逐步引导你开发一个属于你自己的 MCP Server，实现可控、可组合的智能体协作能力。

通过本教程的学习，你将掌握 MCP 在工程中的实际应用方法，并为构建更具可维护性和可扩展性的 AI 系统打下坚实基础。

## 一、MCP简介

MCP是什么：MCP 是一种**专为 LLM 设计的标准化协议**。它不是一个具体的工具，而是一套**规则和约定**，定义了如何将外部世界的复杂、原始数据（如网页、文档、API 响应、数据库记录等）**转化、组织和描述**成 LLM 能够直接理解并有效利用的**结构化上下文信息**。你可以把它想象成 LLM 的“**通用翻译器**”和“**信息整理器**”。MCP 如同大模型的 **Type-C 接口**：它终结了工具交互的碎片化时代，通过统一协议让大模型无需定制适配器即可连接任意数据源（网页/数据库/API），实现即插即用的结构化数据传输，彻底解决"一个工具一种接口"的低效困境。类似地，MCP Server 上可以“插”上各种提供上下文的“插件”，LLM 可以根据需要向 MCP Server 请求这些插件，从而获取更丰富的上下文信息，增强自身能力。

MCP 遵循客户端-服务器架构，其中主机应用程序可以连接到多个服务器：

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/76ce57ac-5e99-4961-ba6f-35e2243130a3.png)

主要有以下几个部分：

*   **MCP Hosts**：MCP 主机：想要通过 MCP 访问数据的程序，如 Claude 桌面版、IDE 或 AI 工具
    
*   **MCP Clients**：MCP 客户端：与服务器保持 1:1 连接的协议客户端
    
*   **MCP Servers**：MCP 服务器：通过标准化的模型上下文协议暴露特定功能的小型程序
    
*   **Local Data Sources**：本地数据源：您的计算机文件、数据库和服务，MCP 服务器可以安全访问
    
*   **Remote Services**：远程服务：可通过互联网（例如通过 API）访问的外部系统，MCP 服务器可以连接
    

## 二、MCP为什么能拓展大语言模型的能力边界

在这一节，我们借助Cherry Studio平台（充当MCP Client的角色），通过浅显易懂的一个**直观的网页内容分析实验**讲明白到底什么是MCP（Model Context Protocol）。通过对比「未启用MCP」和「启用MCP」两种场景，直观展示MCP为什么是大模型和其他工具之间的统一接口。

### 第一步：打开cherry studio

打开Cherry Studio

```bash
./Cherry-Studio-1.4.3-arm64.AppImage 
```

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/f776c01c-be4e-402d-b83b-c19ca5f7a8a5.png)

### 第二步：安装uv、bun

在 `设置 - MCP 服务器` 中，点击 `安装` 按钮，即可自动下载并安装。因为是直接从 GitHub 上下载，速度可能会比较慢，且有较大可能失败。安装成功与否，以下文提到的文件夹内是否有文件为准。

< Cherry Studio目前只使用内置的uv和bun，不会复用系统中已经安装的uv和bun。

![截图 2025-06-20 14-54-01.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/18639303-10ea-49ce-9d75-118df5e0d135.png)

**可执行程序安装目录：**

Windows: `C:\Users\用户名\.cherrystudio\bin`

macOS、Linux: `~/.cherrystudio/bin`

### 第三步：配置MCP Server

#### 3.1 打开设置，找到`**MCP 服务器**` 选项。点击 `**添加服务器**`。

### ![截图 2025-06-20 14-46-53.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/65687eaa-a2a8-4657-ab4d-6f25521efd2b.png)

#### 3.2 将MCP Server的相关参数填入后，点击保存。

*   名称：自定义一个名称，例如 `fetch-server`
    
*   类型：选择 `STDIO`
    
*   命令：填写 `uvx`
    
*   参数：填写 `mcp-server-fetch`
    

（其他参数，视具体 Server 而定）

< @cherry/fetch: 用于获取 URL 网页内容的 MCP 服务器。

![截图 2025-06-20 15-07-17.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/13289fd5-2485-4973-9368-53e19115a572.png)

完成上述配置后，Cherry Studio 会自动下载所需的 MCP Server - `fetch server`。下载完成后，我们就可以开始使用了！

注意：当 mcp-server-fetch 配置不成功的时候，可以尝试重启一下电脑。

### 第三步：在聊天框中启用MCP服务器

在 `MCP 服务器` 设置成功添加了 MCP 服务器 `fetch server`

![截图 2025-06-20 15-13-07.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/7989d4b9-646a-475f-930a-23402ce84b40.png)

### 第四步： MCP：大模型理解真实世界的"翻译官"

🔍 一个实验揭示MCP的核心价值：我们通过一个简单的对比实验，直观展示MCP如何解决大模型的核心痛点：

实验设置：让大模型分析网页内容，并解答问题

#### 未开启MCP时：模型如同"盲人摸象"

对大模型提出如下问题

```bash
你是一位内容分析师。请基于以下网址内容进行分析：
https://www.aibook.net.cn/ai-book
请回答：
1. 该内容的核心内容是什么？
2. 这篇文章介绍是什么，我如何能获取这个网站的更多信息？
```

得到如下结果

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/a029234d-786e-4c74-950f-3fc40a781d99.png)

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/b04ac148-2667-4aea-aae2-2bc990775759.png)

当直接提供网址时，模型只能根据URL中的关键词（如"aibook"）进行**模糊猜测**

**问题本质**：

> 大模型本质是"文本理解专家"，无法直接处理原始数据（网页/PDF/数据库）。就像给人类一本俄语书却要求他理解内容 - 文字就在眼前，但无法解读。

####  开启MCP后：模型获得"数据透视眼"

启用MCP Server之后，我们再次提出相同的问题，得到精准回答

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/882db185-9cde-4755-8e07-f4b5199b83e4.png)

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/db298f04-0730-4b4e-a5a3-4c5344da40f3.png)

**关键转变**：

MCP Server充当了**数据翻译官**的角色，将原始网页转化为模型能理解的结构化信息

![deepseek_mermaid_20250620_29af8d.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/8oLl952kJPDL0lap/img/d5d7848e-3b04-4c1f-9bf7-f01ffc1ac1ca.png)

开启MCP Server之后，大模型就可以根据获取到的结构化信息信息，进行数据处理。无论是网页、文件还是数据库，都可以利用MCP进行交互。更多的MCP Server类型，等你去探索。

#### 💡 为什么MCP是革命性突破？

在MCP出现前，我们主要依靠两种方式扩展模型能力：

| **方案** | **代表技术** | **局限性** |
| --- | --- | --- |
| 原始文本输入 | 直接粘贴内容 | 处理复杂数据效率极低 |
| 函数调用 | Function Call | 需为每个工具开发定制接口开发复杂 |
| **协议层方案** | **MCP** | **统一标准，开箱即用** |

## 三、使用不同MCP Server和MCP Client

这一节，我们以Cursor和Cherry studio作为示例MCP client，自定义MCP server为例介绍MCP作为工具的使用方法。

### 第一步 MCP自定义配置

#### 1.1 获取MCP Server

MCP协议发布至今，已经有无数开发者开源了许多有用的MCP Server供广大用户使用，我们可以从一些常用的MCP广场获取到我们想要的好用的工具，如魔搭社区的MCP广场，MCP.so等网站。这些开源项目通常自带了配置和使用json。

### 第二步 在Cursor中配置MCP Server

#### 2.1 在cursor中使用MCP Sercer

##### 2.1.1 添加MCP Server

##### 打开设置，点击Tools&Integrations，在MCP Tools中点击Add Custom MCP

![截图 2025-07-04 10-28-23.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/9905358b-ee1d-4cdc-9995-0916d966061e.png)

编写json文件，示例如下，也可以填入你喜欢的开源项目提供的json

```shell
{
  "mcpServers": {
    "demo-server": {
      "name": "Demo MCP 服务器",
      "type": "stdio",
      "description": "我的 Demo MCP 服务器，提供加法工具",
      "isActive": true,
      "registryUrl": "",
      "command": "uv",
      "args": [
        "--directory",
        "/home/project30_mcp_server/mcp_server",#修改为你的实际路径
        "run",
        "main.py"
      ],
      "cwd": "/home/project30_mcp_server/mcp_server"#修改为你的实际路径
    }
  }
}
```

保存后，显示绿色图标，可以看到我们的mcp已经可以正常工作了

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/4c42feb4-e682-4765-a160-fa186ab20f37.png)

##### 2.1.2 使用MCP server

在右侧AI栏中提出一个包含加法的问题，可以看到大模型调用了MCP工具进行了加法运算。

![截图 2025-07-04 12-09-24.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/63dbca3b-101c-4f93-a72b-e786623215e3.png)

### 第三步 在Cherry studio中配置MCP

#### 3.1 在Cherry studio中添加并使用MCP服务器

##### 3.1.1 导入MCP Server

在cherry studio中，点击设置，打开MCP服务器

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/019d0256-4c3b-45d5-beb8-31cd16cb18cd.png)

点击添加服务器，选择从json导入（与cursor中的json相同）

```shell
{
  "mcpServers": {
    "demo-server": {
      "name": "Demo MCP 服务器",
      "type": "stdio",
      "description": "我的 Demo MCP 服务器，提供加法工具",
      "isActive": true,
      "registryUrl": "",
      "command": "uv",
      "args": [
        "--directory",
        "/home/project30_mcp_server/mcp_server",#修改为你的实际路径
        "run",
        "main.py"
      ],
      "cwd": "/home/project30_mcp_server/mcp_server"#修改为你的实际路径
    }
  }
}
```

点击添加，打开开关，显示绿色连通标志证明MCP配制成功。

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/27429723-aaaf-43e0-af4a-0850f23fb9aa.png)

##### 3.1.2 在cherry studo中使用MCP

返回主界面，在对话框下方点击MCP服务器，点击打开。

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/cfbbbf41-9f39-4de4-8942-3204cebbd640.png)

接下来输入你的问题，我们发现LLM可以自行调用MCP服务器进行工作了

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/587d9c8f-0af4-4887-bd50-16e3cc2e18ae.png)

### 第四步MCP Server的能力展现

这里用一个简单的对比示例来展现MCP Server的实际意义

我们提出一个相对难一些的数学问题，32904789加上239047097800是多少，让DeepSeek R1回答这个问题。![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/ae1bf4dc-070f-4ad8-a975-21297d249413.png)

DeepSeek R1虽然回答了这个问题，但是有一个惊人的意外，它的深度思考用时居然长达**280.6**秒。

这里展示一下在此次运行时Deepseek的思考过程。

```shell
首先，用户的问题是：“32904789加上239047097800是多少？”这是一个简单的加法问题。我需要计算32904789 + 239047097800。

让我写出这两个数字：

第一个数字：32,904,789（我添加了逗号以便阅读）

第二个数字：239,047,097,800（同样添加了逗号）

在计算时，我应该去掉逗号，直接使用数字：32904789 和 239047097800。

现在，我需要将它们相加。由于第二个数字比第一个大得多，我应该对齐它们以便加法。

第二个数字是239047097800，它有12位数字：

239,047,097,800
第一个数字是32904789，它有8位数字：

32,904,789
所以，在加法时，我需要将第一个数字对齐到第二个数字的右边。

让我写出第二个数字：239047097800

然后，第一个数字：32904789，应该对齐到最右边：

所以：

239047097800

32904789
现在，我需要从右向左逐位相加。

首先，写出两个数字，确保位数对齐。第二个数字有12位，第一个有8位，所以我应该在第一个数字前面补零，使其成为12位。

32904789 有8位，所以补4个零：000032904789？不，那会改变数字的值。实际上，在加法时，我应该将第一个数字对齐到右边，所以：

第二个数字：239047097800

第一个数字：由于它较短，应该放在右边：000032904789？不，那是不正确的。

标准加法对齐：从右端对齐。

所以：

239047097800

32904789
但为了清晰，我可以写成：

239047097800

0032904789 等等，不对。
32904789 是8位数，所以当对齐时，它应该对应于第二个数字的最后8位。

所以，第二个数字：239047097800

分解：

百亿位：2

十亿位：3

亿位：9

千万位：0

百万位：4

十万位：7

万位：0

千位：9

百位：7

十位：8

个位：0

实际上，更好的是按位值对齐。

设第二个数字为 A = 239047097800

第一个数字为 B = 32904789

A 有12位，B有8位，所以B相当于A的最后8位。

在加法中：

从个位开始：

A的个位是0（因为239047097800以00结尾？等一下，让我确认。

239047097800 — 最后两位是00，所以个位是0，十位是0。

B = 32904789，个位是9，十位是8。

所以：

个位：0 + 9 = 9

十位：0 + 8 = 8

百位：A的百位是7（因为097800，百位是7），B的百位是7（32904789，百位是7？32904789：最后三位是789，所以百位是7。

32904789：从右：个位9，十位8，百位7，千位4，万位0，十万位9，百万位2，千万位3？等等。

让我正确写出B：32,904,789

所以：

个位：9

十位：8

百位：7

千位：4

万位：0（10^4）

十万位：9（10^5）

百万位：2（10^6）

千万位：3（10^7）

现在A：239,047,097,800

这是239亿4709万7800？标准位值。

个位：0

十位：0

百位：8？等等，097800 — 所以百位是8？097800：八百位是8？097800的意思是97,800，所以：

个位：0

十位：0

百位：8

千位：7

万位：9？等等，047097800。

更好的是：239047097800

从右到左：

位 0（个位）：0

位 1（十位）：0

位 2（百位）：8

位 3（千位）：7

位 4（万位）：9

位 5（十万位）：0

位 6（百万位）：7

位 7（千万位）：4

位 8（亿位）：0

位 9（十亿位）：3

位 10（百亿位）：9？239047097800 — 总共12位。

位置从右开始：

位置：11 10 9 8 7 6 5 4 3 2 1 0

数字：2  3  9 0 4 7 0 9 7 8 0 0

所以：

位 0: 0

位 1: 0

位 2: 8

位 3: 7

位 4: 9

位 5: 0

位 6: 7

位 7: 4

位 8: 0

位 9: 9

位 10: 3

位 11: 2

现在 B = 32904789，8位数字：位置从 7 到 0：

位置：7 6 5 4 3 2 1 0

数字：3 2 9 0 4 7 8 9

所以：

位 0: 9

位 1: 8

位 2: 7

位 3: 4

位 4: 0

位 5: 9

位 6: 2

位 7: 3

现在，对于加法，我们按位相加，从位 0 开始。

对于 A 和 B，当位不存在时，视为 0。

所以，从位 0 开始：

位 0：A 有 0，B 有 9，和 = 0 + 9 = 9，进位 = 0（因为 <10）

位 1：A 有 0，B 有 8，和 = 0 + 8 = 8，进位 = 0

位 2：A 有 8，B 有 7，和 = 8 + 7 = 15，所以写 5，进位 = 1

位 3：A 有 7，B 有 4，和 = 7 + 4 = 11，加上进位 1 = 12，所以写 2，进位 = 1

位 4：A 有 9，B 有 0，和 = 9 + 0 = 9，加上进位 1 = 10，所以写 0，进位 = 1

位 5：A 有 0，B 有 9，和 = 0 + 9 = 9，加上进位 1 = 10，所以写 0，进位 = 1

位 6：A 有 7，B 有 2，和 = 7 + 2 = 9，加上进位 1 = 10，所以写 0，进位 = 1

位 7：A 有 4，B 有 3，和 = 4 + 3 = 7，加上进位 1 = 8，所以写 8，进位 = 0

现在，更高位：位 8、9、10、11 只在 A 中有。

位 8：A 有 0，B 没有（视为 0），加上进位 0 = 0，写 0

位 9：A 有 9，B 没有，和 = 9 + 0 = 9，写 9

位 10：A 有 3，B 没有，和 = 3 + 0 = 3，写 3

位 11：A 有 2，B 没有，和 = 2 + 0 = 2，写 2

现在，没有进位了。

所以，组合所有位，从高位到低位：

位 11:2, 位 10:3, 位 9:9, 位 8:0, 位 7:8, 位 6:0, 位 5:0, 位 4:0, 位 3:2, 位 2:5, 位 1:8, 位 0:9

所以，数字是：23908002589？让我写下来：

从位11到0：2,3,9,0,8,0,0,0,2,5,8,9

所以，239080002589？位7是8，位6是0，位5是0，位4是0，位3是2，等等。

序列：位11:2, 10:3, 9:9, 8:0, 7:8, 6:0, 5:0, 4:0, 3:2, 2:5, 1:8, 0:9

所以，数字：239080002589

但让我确认一下：239,080,002,589

现在，为了验证，我可以考虑加法。

A = 239047097800

B = 32904789

和应该大约是239047097800 + 32904789 ≈ 239,047,130,000左右，但让我们检查一下。

239080002589 - 239047097800 = ? 但也许直接相加更好。

另一种方式：由于B很小，但为了精确。

我可以计算：

239047097800 + 32904789

首先，注意到A以800结尾，B是32904789。

但从之前的计算，我们有239080002589

让我一步一步地加。

对齐：

239,047,097,800

32,904,789
现在，从右边开始：

800 + 789 = 1589 → 写589，进位1？800 + 789 = 1589，所以个十百位：589，进位1到千位。

更清晰：

个位：0 + 9 = 9

十位：0 + 8 = 8

百位：8 + 7 = 15，写5，进位1

千位：7（来自097的7？等一下，097800的千位是7？之前：A的千位是7（位3）

B的千位是4（32904789，千位是4？32,904,789 — 千位是4）

所以千位：A有7，B有4，加上百位的进位1：7 + 4 + 1 = 12，写2，进位1

万位：A有9（047097800，万位是9？之前位4是9）

B有0（32904789，万位是0？32,904,789 — 万位是0）

所以万位：9 + 0 + 进位1 = 10，写0，进位1

十万位：A有0（047097800，十万位是0？位5是0）

B有9（32904789，十万位是9）

所以十万位：0 + 9 + 进位1 = 10，写0，进位1

百万位：A有7（239047097800，百万位是7？位6是7）

B有2（32904789，百万位是2）

所以7 + 2 + 进位1 = 10，写0，进位1

千万位：A有4（位7是4）

B有3（32904789，千万位是3）

所以4 + 3 + 进位1 = 8，写8

亿位：A有0（位8是0）

B没有，所以0 + 0 = 0（没有进位）

十亿位：A有9（位9是9）

B没有，所以9

百亿位：A有3（位10是3？之前位10是3，但数字是239047097800，所以百亿位是2？等等。

在位置中：位11是2（百亿位？），位10是3（十亿位），位9是9（亿位），等等。

标准：对于239,047,097,800

百亿位：2（因为200亿）

十亿位：3（30亿，但总共239亿）

239亿是23,900,000,000，但这里是239,047,097,800，所以：

200亿 + 30亿 + 9亿 = 239亿，没错。

所以，亿位以上：A有239,047（但047是百万？最好坚持按位。

在加法中：

在千万位之后，我们有：

亿位：A有0（来自047,097,800 — 亿位是0？239,047,097,800 — 047百万？047,097,800 是47,097,800，所以亿位是0？因为047表示47百万，所以亿位是0。

之前的位置：位8（亿位）是0。

位9（十亿位）是9？位9是9，但十亿位应该是10^9。

在239047097800中：

百亿位 (10^10)：2

十亿位 (10^9)：3

亿位 (10^8)：9

千万位 (10^7)：0

百万位 (10^6)：4

十万位 (10^5)：7

万位 (10^4)：0

千位 (10^3)：9

百位 (10^2)：7

十位 (10^1)：8

个位 (10^0)：0

我之前说位4是万位，是9，但万位是10^4，应该是9？239047097800，从右数第五位是0？我们列出数字：从左到右：2,3,9,0,4,7,0,9,7,8,0,0

所以：

索引0（最右）：0（个位）

索引1：0（十位）

索引2：8（百位）？不对：

如果索引0是个位，那么：

索引0：0

索引1：0（十位）

索引2：8（百位？800的百位是8？800是8百，所以百位是8）

索引3：7（千位？7800的千位是7？7800 / 1000 = 7.8，所以千位是7）

索引4：9（万位？097800 / 10000 = 9.78，所以万位是9）

索引5：0（十万位？097800 / 100000 = 0.978，所以十万位是0？但047097800，索引5是0）

数字：索引11:2, 10:3, 9:9, 8:0, 7:4, 6:7, 5:0, 4:9, 3:7, 2:8, 1:0, 0:0？我之前有不同。

标准：对于一个数字，最右边是个位。

所以对于 239047097800：

位置 0（个位）：0

位置 1（十位）：0

位置 2（百位）：8（因为最后三位是800）

最后三位：800，所以百位：8，十位：0，个位：0。

但整个数字：从左到右：第1位：2（百亿位），第2位：3（十亿位），第3位：9（亿位），第4位：0（千万位），第5位：4（百万位），第6位：7（十万位），第7位：0（万位），第8位：9（千位），第9位：7（百位），第10位：8（十位），第11位：0（个位）？不对。

最好把它当作一个字符串。

数字：d11 d10 d9 d8 d7 d6 d5 d4 d3 d2 d1 d0 = 2,3,9,0,4,7,0,9,7,8,0,0

所以：

d0 = 0（个位）

d1 = 0（十位）

d2 = 8（百位）？d2 是第3位？索引。

定义：设索引 i 表示 10^i 的位置。

所以：

i=0：个位：数字是？从右边数：位置0：最右边的数字是0（个位）
位置1：十位：0（因为00）

位置2：百位：8（因为800中的8）

位置3：千位：7（7800中的7）

位置4：万位：9（097800中的9？097800是97800，万位是9）

位置5：十万位：0（047097800？047097800是47097800，十万位是7？混乱。

数字是239,047,097,800

分组：239,047,097,800

所以，十亿位：239

百万位：047

千位：097

个位：800

所以，更清晰：

百亿位：2（因为200,000,000,000）

十亿位：3（30,000,000,000）

亿位：9（9,000,000,000） 总共239,000,000,000

千万位：0（0 * 10,000,000）

百万位：4（4,000,000）

十万位：7（700,000） 所以047,000,000 是47,000,000？047百万是47,000,000，所以：

百万位：4（四百万），十万位：7（七十万），所以047表示四千七百万。

然后097,800：九万七千八百。

所以：

百亿位：2

十亿位：3

亿位：9

千万位：0（因为047中千万位是0？四千七百万是47,000,000，所以千万位是0？47,000,000 / 10,000,000 = 4.7，所以千万位是4？不对。

标准位值：

47,000,000：

千万位：4（因为40,000,000）

百万位：7（7,000,000）

但在整个数字中，239,047,097,800：

所以：

百亿位 (10^10)：2

十亿位 (10^9)：3

亿位 (10^8)：9

千万位 (10^7)：0（因为047,000,000 — 047表示四千七百万，所以千万位是4？047,000,000是47,000,000，即410,000,000 + 71,000,000，所以千万位是4，百万位是7。

我把自己搞糊涂了。

我们写下完整的数字：239,047,097,800

这意味着：

239 * 1,000,000,000 = 239,000,000,000

047 * 1,000,000 = 47,000,000

097 * 1,000 = 97,000？097,800 是97,800

但097,800 是97,800，不是097*1000。

在逗号分隔中，239,047,097,800 通常是：

239亿

047百万

097千

800个

所以，239,000,000,000

047,000,000？047百万是47,000,000

097千是97,000？097千是97,000，但它是097,800，所以可能是097千和800个，但097千是97,000，加上800是97,800。

在标准记法中，239,047,097,800 是：

两百三十九亿四千七百零九万七千八百。

所以，位值：

百亿位：2

十亿位：3

亿位：9

千万位：4（因为四千七百万）

百万位：7（四千七百万）

十万位：0（097,800 的十万位是0？九万七千八百，所以十万位是0）

万位：9（九万）

千位：7（七千）

百位：8（八百）

十位：0

个位：0

097,800：九万七千八百，所以：

万位：9

千位：7

百位：8

十位：0

个位：0

而前面的047：是百万位部分，047表示四千七百万，所以：

千万位：4（因为40,000,000）

百万位：7（7,000,000）

然后239：二百三十九亿，所以：

百亿位：2（200,000,000,000）

十亿位：3（30,000,000,000）

亿位：9（9,000,000,000）

所以总结：

10^10：2

10^9：3

10^8：9

10^7：4（千万）

10^6：7（百万）

10^5：0（十万）— 因为047之后是097,800，而097,800的十万位是0（九万，不是九十万）

10^4：9（万）

10^3：7（千）

10^2：8（百）

10^1：0（十）

10^0：0（个）

所以数字序列：从10^10到10^0：2,3,9,4,7,0,9,7,8,0,0

即：23947097800，但这是11位数字，而原始数字有12位？239047097800是12位：2,3,9,0,4,7,0,9,7,8,0,0 —— 是的，在10^7和10^6之间有一个0？根据上面，10^7是4，10^6是7，但序列中在9（10^8）之后是4（10^7），然后7（10^6），然后0（10^5），等等。

在字符串中：位置从左边：1:2（10^11？不对。

如果数字是d_{11} d_{10} ... d_0，其中d_0是个位。

那么d_0 = 0（个位）

d_1 = 0（十位）

d_2 = 8（百位）

d_3 = 7（千位）

d_4 = 9（万位）

d_5 = 0（十万位）— 因为047097800，d_5是0（数字序列中的第七位？）

列出数字字符串：从左到右：索引0: '2'，索引1: '3'，索引2: '9'，索引3: '0'，索引4: '4'，索引5: '7'，索引6: '0'，索引7: '9'，索引8: '7'，索引9: '8'，索引10: '0'，索引11: '0'？如果12位数字，索引从0到11，索引0是最高位。

标准是：对于一个数字，最左边是最高位。

所以对于239047097800，数字是：

位置0（最左边）：2（10^11）

位置1：3（10^10）

位置2：9（10^9）

位置3：0（10^8）— 等等，但之前我认为是亿位。

10^11是百亿位（100,000,000,000），所以2*100,000,000,000

10^10是十亿位（10,000,000,000），3*10,000,000,000

10^9是亿位（1,000,000,000），91,000,000,000？2100,000,000,000 = 200,000,000,000

3*10,000,000,000 = 30,000,000,000

9*1,000,000,000 = 9,000,000,000

总和 239,000,000,000

然后位置3：0（10^8？100,000,000），但下一个数字是0，所以0*100,000,000

位置4：4（10^7？10,000,000），4*10,000,000 = 40,000,000

位置5：7（10^6？1,000,000），7*1,000,000 = 7,000,000

位置6：0（10^5？100,000），0*100,000

位置7：9（10^4？10,000），9*10,000 = 90,000

位置8：7（10^3？1,000），7*1,000 = 7,000

位置9：8（10^2？100），8*100 = 800

位置10：0（10^1？10），0*10

位置11：0（10^0？1），0*1

总和：239,000,000,000 + 40,000,000 + 7,000,000 + 90,000 + 7,000 + 800 = 239,047,097,800 是的。

所以数字：d11=0（个位），d10=0（十位），d9=8（百位），d8=7（千位），d7=9（万位），d6=0（十万位），d5=7（百万位），d4=4（千万位），d3=0（亿位），d2=9（十亿位），d1=3（百亿位），d0=2（千亿位？10^11是千亿位，但通常称为百亿，不过无论如何。

在加法中，我们使用索引。

A：d0=2，d1=3，d2=9，d3=0，d4=4，d5=7，d6=0，d7=9，d8=7，d9=8，d10=0，d11=0

B：32904789，即8位数字：e0=3（10^7），e1=2（10^6），e2=9（10^5），e3=0（10^4），e4=4（10^3），e5=7（10^2），e6=8（10^1），e7=9（10^0）——但B是32,904,789，所以：

10^7：3

10^6：2

10^5：9

10^4：0

10^3：4

10^2：7

10^1：8

10^0：9

所以对于加法，从 i=0 到 11 的每个位置。

对于 i 从 0 到 11，A 有数字，B 有数字当 i<8，否则为 0。

B 的最高位是 10^7，所以对于 i>7，B 为 0。

从 i=0 开始（个位）：

A_i = d11（因为 d11 是 10^0），之前我定义 d_k 为 10^k 的位置，但索引上不一致。

定义：令位置 i 表示 10^i 的位置。

所以对于 A = 239047097800

i=0（个位）：0

i=1（十位）：0

i=2（百位）：8

i=3（千位）：7

i=4（万位）：9

i=5（十万位）：0

i=6（百万位）：7

i=7（千万位）：4

i=8（亿位）：0

i=9（十亿位）：9

i=10（百亿位）：3

i=11（千亿位）：2

i=11 是 10^11 = 100,000,000,000，是的，2*100,000,000,000 = 200,000,000,000，正确。

B = 32904789

i=0（个位）：9

i=1（十位）：8

i=2（百位）：7

i=3（千位）：4

i=4（万位）：0

i=5（十万位）：9

i=6（百万位）：2

i=7（千万位）：3

当 i>7 时，B_i=0

现在加法：设进位 carry=0

从 i=0 开始：

和 = A_i + B_i + carry = 0 + 9 + 0 = 9，数字=9，进位=0

i=1：0 + 8 + 0 = 8，数字=8，进位=0

i=2：8 + 7 + 0 = 15，数字=5，进位=1

i=3：7 + 4 + 1 = 12，数字=2，进位=1

i=4：9 + 0 + 1 = 10，数字=0，进位=1

i=5：0 + 9 + 1 = 10，数字=0，进位=1

i=6：7 + 2 + 1 = 10，数字=0，进位=1

i=7：4 + 3 + 1 = 8，数字=8，进位=0

i=8：0 + 0 + 0 = 0，数字=0，进位=0（B_i=0）

i=9：9 + 0 + 0 = 9，数字=9，进位=0

i=10：3 + 0 + 0 = 3，数字=3，进位=0

i=11：2 + 0 + 0 = 2，数字=2，进位=0

所以得到的数字：从 i=11 到 i=0：2,3,9,0,8,0,0,0,2,5,8,9

所以这个数是 239080002589

写成 239,080,002,589

现在，为了确认，A + B = 239047097800 + 32904789 = 239080002589

我可以计算：239047097800 + 32904789 = 239047097800 + 32904789

注意 239047097800 + 32904789 = 239047130000 - ？但也许直接相加。

239047097800 + 32904789 = 239047097800 + 32900000 + 4789 = 239047130800 + 4789？不太好。

从加法来看，由于进位，应该是正确的。

所以和是 239,080,002,589

在框中，我应该写出这个数字。

所以答案是 239080002589

为了可读性，可以加上逗号，但在框中可能不需要。

用户输入时没有逗号，所以输出也不加逗号。

所以 \boxed{239080002589}

但让我再确认一次加法。

A: 239047097800

B:    32904789

相加：

写下来：

239047097800

32904789
从右边开始：

0 + 9 = 9

0 + 8 = 8

8 + 7 = 15，写5，进位1

7 + 4 + 1 = 12，写2，进位1

9 + 0 + 1 = 10，写0，进位1

0 + 9 + 1 = 10，写0，进位1

7 + 2 + 1 = 10，写0，进位1

4 + 3 + 1 = 8，写8

0 + 0 = 0（但还有进位？不，这里没有进位）

然后 9,3,2 保持不变，但更高位。

在 i=7 之后，我们有 i=8: A 有 0，B 没有，所以 0

i=9:9，i=10:3，i=11:2

所以：239080002589？在部分：在千万位之后，我们写了8，然后亿位 A 是 0，所以是 0，十亿位是 9，百亿位是 3？但数字是 239047097800，所以亿位是 0（在 239 之后），但 239 是十亿和百亿，所以更高位是 239，但我们在 i=6 和 i=7 有进位，但 i=7 是千万位，i=8 是亿位。

在加法中，当我们写的时候：

在加完百万位之后，我们有：

从右边：... 然后千万位：4（A）+3（B）+ 进位1（来自百万位）=8

然后亿位：A 是 0，B 是 0（因为没有），进位是 0，所以 0

十亿位：9

百亿位：3

千亿位：2？i=11 是 10^11，是 2。

所以数字是：239080002589，是的。

为了验证，239047097800 + 32904789 = ?

计算 239047097800 + 32904789 = 239047130847？不对。

注意 239047097800 + 32904789 = 239047097800 + 32904789。

添加：800 + 789 = 1589，所以最后三位是 589，进位 1。

然后 097 + 047 + 1？但 097 是千位和万位，等等。

从之前的逐步计算来看，是一致的。

所以我认为这是正确的。
```

让大模型 (DeepSeek) 直接进行这个计算，它耗时 280 秒才给出答案——甚至发现，其思考过程类似人类列竖式，既繁琐又低效。想想看，人类遇到这种精确计算需求，第一反应通常是找工具（如计算器），而非埋头苦算。

接下来让我们看一下使用同样的模型，打开MCP服务器之后的效果。

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/544087ef-90d6-4bf5-be6a-0dd55293005e.png)

接入我们的 MCP Server 后，情况截然不同：模型仅用 15 秒就给出了正确答案。大模型的思考过程重点放在了判断要调用工具上。这个MCP Server 的核心作用，正是为模型提供了一个类似“计算器”的工具。

所以MCP（模型上下文协议）的最大作用，就是统一了各类工具的接入标准，极大简化了工具开发流程，并降低了模型认知和使用工具的难度。MCP Server作为其中重要的一个环节，为大模型赋予了更多的能力。

## 四、从0开始编写MCP Server

### 第一步：环境准备

MCP Server本质上就是一段程序，为了方便开发，我们要获取官方的开发工具包（SDK）

#### 1.1 安装uv

MCP推荐使用uv管理项目。打开链接[uv](https://docs.astral.sh/uv/)选择合适的方式进行安装。

```shell
curl -LsSf https://astral.sh/uv/install.sh | sh
```

![截图 2025-07-03 17-54-24.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/ac3c3ae1-72c3-43ad-819d-035d60c2204c.png)

提示PATH设置未生效，安装目录尚未加入系统路径。

运行如下命令，使该命令对所有终端生效

```shell
# 如果你用 bash/zsh/sh (默认)
echo 'source $HOME/.local/bin/env' >> ~/.bashrc && source ~/.bashrc

# 如果你用 fish
echo 'source $HOME/.local/bin/env.fish' >> ~/.config/fish/config.fish && source ~/.config/fish/config.fish
```

验证安装是否成功

```shell
uv --version
```

正常应输出：`uv 0.7.19`

#### 1.2 创建第一个mcp\_server

##### 1.2.1 创建文件夹并打开

创建一个名为mcp\_server的文件夹，并在终端中打开

输入下列命令，将你创建的文件夹初始化为一个python工程

```shell
uv init .
```

添加MCP到你的项目依赖中：

```shell
uv add "mcp[cli]"
```

![截图 2025-07-03 18-15-37.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/00fd4747-dcd8-4122-abc7-42facd0e1de8.png)

##### 1.2.2 使用Cursor编写MCP server

打开Cursor，打开刚刚的mcp\_server文件夹

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/71b6a785-eba8-4bf9-8717-1bc109b535b7.png)

可以看到uv已经帮我们配置好了开发环境。.venv是运行于该项目的虚拟环境

打开终端，输入python main.py，成功打印结果。

![截图 2025-07-03 18-23-26.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/e05240b7-6edc-494f-b1cb-80ff0872aa33.png)

此时，我们已经能够运行独立的MCP开发工具了。

### 第二步：编写自己的MCP

第三步，我们搭建一个基于 MCP 框架构建的智能时间管理服务器，可以与 AI 平台（如 Cursor、Cherry Studio）无缝集成，提供时间查询、提醒设置和倒计时等功能。支持相对时间（如“10分钟后”）和绝对时间（如“2025-01-16T09:00:00”）。

有了这个MCP Server 大模型就可以化身有时间概念的聪明助手，这个 MCP 时间管理服务器可以让你的 AI 助手拥有“会看时间、会提醒、会计时、会管理待办”的能力。就像给你的Deepseek递了一块手表，有什么时间相关的问题都可以迎刃而解了。

核心功能：

*   时间查询：支持标准格式和中文语义格式
    

*   智能提醒：支持相对时间和绝对时间设置
    
*   倒计时功能：支持各种时长的倒计时管理
    
*   数据持久化：自动保存和恢复数据
    
*   AI 友好：专为大语言模型设计的工具接口
    

#### 2.1 获取项目代码

克隆项目代码

从 Gitee 克隆代码（假设你的仓库地址为git@gitee.com:mthreadsacademy/project100.git，请替换为实际地址）：

```bash
git clone git@gitee.com:mthreadsacademy/project100.git
```

#### 2.2 代码模块划分

工具函数：

```shell
get_current_time()：获取当前时间
set_reminder()：设置提醒
list_reminders()：查看提醒列表
check_triggered_reminders()：检查已触发提醒
acknowledge_reminder()：确认提醒
cancel_reminder()：取消提醒
start_countdown()：开始倒计时
list_countdowns()：查看倒计时列表
get_countdown_status()：获取倒计时状态
cancel_countdown()：取消倒计时
```

资源接口

```shell
time://current：当前时间
reminders://active：活跃提醒
countdowns://running：运行中倒计时

```

辅助函数：

```shell
load_data() / save_data()：数据持久化
parse_duration()：时间字符串解析
format_time_semantic()：语义化时间
log_message()：日志输出
monitor_service()：后台监控
```

#### 2.3 将MCP Server接入Cursor

打开设置，点击Tools&Integrations，在MCP Tools中点击Add Custom MCP

![截图 2025-07-04 10-28-23.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/9905358b-ee1d-4cdc-9995-0916d966061e.png)

修改json文件，添加如下内容。

```shell
{
  "mcpServers": {
    "time-server": {
      "name": "时间管理 MCP 服务器",
      "type": "stdio", 
      "description": "时间管理服务器，提供时间查询、提醒设置和倒计时功能",
      "isActive": true,
      "registryUrl": "",
      "command": "uv",
      "args": [
        "--directory",
        "/home/project30_mcp_server/mcp_server_time",#你的项目路径
        "run",
        "main.py"
      ],
      "cwd": "/home/project30_mcp_server/mcp_server_time"#你的项目路径
    }
  }
}
```

保存后，显示绿色图标，可以看到我们的mcp已经可以正常工作了

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/33e036c4-54bf-44c2-be08-6e3779611eaa.png)

此时，就可以在Cursor中和大模型对话了，原来解决不了的时间问题现在都迎刃而解，你可以问他现在几点；预定一个三小时后的会议；10分钟后提醒我喝水；40小时后是什么时间。

#### 2.3 在Cherry studio中添加并使用MCP服务器

cherry studio的详细安装使用步骤见[《【初级】在AIBOOK上玩转Cherry Studio 》](https://alidocs.dingtalk.com/i/nodes/bva6QBXJwZlMlv7aulzOMPAjVn4qY5Pr?utm_scene=person_space)

##### 2.3.1 导入MCP Server

在cherry studio中，点击设置，打开MCP服务器

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/019d0256-4c3b-45d5-beb8-31cd16cb18cd.png)

点击添加服务器，选择从json导入（与cursor中的json相同）

```shell
{
  "mcpServers": {
    "time-server": {
      "name": "时间管理 MCP 服务器",
      "type": "stdio", 
      "description": "时间管理服务器，提供时间查询、提醒设置和倒计时功能",
      "isActive": true,
      "registryUrl": "",
      "command": "uv",
      "args": [
        "--directory",
        "/home/project30_mcp_server/mcp_server_time",#你的项目路径
        "run",
        "main.py"
      ],
      "cwd": "/home/project30_mcp_server/mcp_server_time"#你的项目路径
    }
  }
}
```

点击添加，打开开关，显示绿色连通标志证明MCP配制成功。

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/91d8c770-1a71-418b-be42-6a125b270b3c.png)

##### 2.3.2 在cherry studo中使用MCP

返回主界面，在对话框下方点击MCP服务器，点击打开。

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0bvPQ44Bnw1/img/eb74eaab-807a-4c05-94e1-a0f8471b91ca.png)

接下来可以在对话中使用MCP工具了。

### 效果展示

#### 未使用时间管理器MCP Server时

![截图 2025-07-08 18-05-24.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0b8JQ4Abnw1/img/8e20bc57-4add-498d-bd68-4452fff80a05.png)

大模型无法准确的告诉我此时的时间，再来看看网页版的DeepSeek

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0b8JQ4Abnw1/img/72c010ad-e524-441b-aa86-763b5fbc5c95.png)

同样没有办法给出具体的时间。

#### 使用时间管理器MCP Server之后

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0b8JQ4Abnw1/img/4e2cb4ca-e6cd-43c0-aa9f-ee1e72c53e2a.png)

不仅能的知道当前的准确时间，还可以根据我的语义自动识别意图帮我设置提醒（虽然目前大模型还不支持主动发起对话进行提醒，但是后期mcp的功能可以接入更智能的client进行使用）

目前该MCP还支持查看待办清单和倒计时等功能。

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0b8JQ4Abnw1/img/13e5c46f-2e77-4235-a0d9-e600067b7d00.png)

![image.png](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4jKqm0b8JQ4Abnw1/img/efce2a58-8d72-42ba-8f62-ee3199203fd2.png)
